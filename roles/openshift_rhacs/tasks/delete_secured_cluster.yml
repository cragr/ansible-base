- import_role:
    name: openshift_common
    tasks_from: delete_kubernetes_objects.yml
  vars:
    delete_kubernetes_objects:
      - api_version: platform.stackrox.io/v1alpha1
        kind: SecuredCluster
        name: stackrox-secured-cluster-services
        namespace: stackrox

- name: Delete stackrox namespace
  kubernetes.core.k8s:
    template: namespace/stackrox-ns.yaml
    wait: true
    state: absent

- name: Delete RHACS operator
  import_role:
    name: openshift_common
    tasks_from: delete_operator.yml
  vars:
    delete_operator_subscription_name: '{{ rhacs_subscription_name }}'
    delete_operator_subscription_namespace: '{{ rhacs_subscription_namespace }}'

- name: Delete RHACS operator namespace
  kubernetes.core.k8s:
    template:
      - operator/rhacs-operator-ns.yaml
    state: absent
    wait: true
