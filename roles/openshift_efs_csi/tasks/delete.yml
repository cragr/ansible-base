- name: Delete test volume
  kubernetes.core.k8s:
    template:
      - test/test-volume-pvc.yaml
    wait: true
    state: absent

- name: Delete AWS EFS CSI storageclass
  kubernetes.core.k8s:
    template:
      - instance/efs-csi-sc.yaml
    wait: true
    state: absent

- name: Delete AWS EFS CSI driver instance
  kubernetes.core.k8s:
    template:
      - instance/efs.csi.aws.com-clustercsidriver.yaml
    wait: true
    state: absent

- name: Delete AWS EFS CSI operator
  import_role:
    name: openshift_common
    tasks_from: delete_operator.yml
  vars:
    delete_operator_subscription_name: '{{ efs_operator_subscription_name }}'
    delete_operator_subscription_namespace: '{{ efs_operator_subscription_namespace }}'
