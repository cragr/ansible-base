- name: Delete Network Observability instance
  kubernetes.core.k8s:
    template:
      - instance/cluster-flowcollector.yaml
      - instance/loki-netobserv-tenant-clusterrole.yaml
      - instance/loki-netobserv-tenant-clusterrolebinding.yaml
    wait: true
    state: absent

- name: Delete Network Observability operator
  import_role:
    name: openshift_common
    tasks_from: delete_operator.yml
  vars:
    delete_operator_subscription_name: '{{ network_observability_subscription_name }}'
    delete_operator_subscription_namespace: '{{ network_observability_subscription_namespace }}'

- import_role:
    name: openshift_loki
    tasks_from: delete.yml
  vars:
    loki_instance_namespace: netobserv
    loki_manage_namespace: false
    loki_instance_tenants_mode: openshift-network

- name: Delete Network Observability namespace
  kubernetes.core.k8s:
    template:
      - instance/netobserv-ns.yaml
    wait: true
    state: absent
