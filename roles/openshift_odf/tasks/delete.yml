- import_tasks: get_infrastructure.yml

- name: Delete ODF instance
  kubernetes.core.k8s:
    definition: "{{ lookup('pipe', 'oc kustomize ' + odf_kustomizations.instance_aws) }}"
    state: absent
  when: infrastructure.resources.0.status.platformStatus.type == 'AWS'

- name: Delete ODF instance
  kubernetes.core.k8s:
    definition: "{{ lookup('pipe', 'oc kustomize ' + odf_kustomizations.instance_openebs) }}"
    state: absent
  when: infrastructure.resources.0.status.platformStatus.type != 'AWS'

- name: Delete ODF operator
  kubernetes.core.k8s:
    definition: "{{ lookup('pipe', 'oc kustomize ' + odf_kustomizations.operator) }}"
    state: absent
