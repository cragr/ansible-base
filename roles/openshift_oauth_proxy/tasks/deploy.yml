- name: Deploy oauth-proxy {{ openshift_oauth_proxy_name }}
  k8s:
    definition: "{{ lookup('template', '{{ item }}') }}"
    namespace: '{{ openshift_oauth_proxy_namespace }}'
  loop:
    - oauth-proxy-clusterrolebinding.yaml
    - oauth-proxy-clusterrole.yaml
    - oauth-proxy-sa.yaml
    - oauth-proxy-deploy.yaml
    - oauth-proxy-svc.yaml
    - oauth-proxy-route.yaml

- import_role:
    name: openshift_common
    tasks_from: wait_for_deployment.yml
  vars:
    wait_for_deployment_name: '{{ openshift_oauth_proxy_name }}'
    wait_for_deployment_namespace: '{{ openshift_oauth_proxy_namespace }}'
