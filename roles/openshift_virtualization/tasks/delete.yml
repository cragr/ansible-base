- import_role:
    name: openshift_autogitops
    tasks_from: app_delete.yml
  vars:
    autogitops_app_name: openshift-virtualization-example
    autogitops_app_path: openshift-virtualization/example-workload
    autogitops_app_namespace: openshift-cnv
    autogitops_app_values: '{{ lookup("template", "example-workload/values.yaml") }}'
  tags:
    - openshift_virtualization_example_workload

- import_role:
    name: openshift_common
    tasks_from: delete_kubernetes_objects.yml
  vars:
    delete_kubernetes_objects:
      - api_version: kubevirt.io/v1
        kind: VirtualMachine
      - api_version: cdi.kubevirt.io/v1beta1
        kind: DataVolume
      - api_version: kubevirt.io/v1
        kind: VirtualMachineInstance

- import_role:
    name: openshift_autogitops
    tasks_from: app_delete.yml
  vars:
    autogitops_app_name: openshift-virtualization
    autogitops_app_path: openshift-virtualization/instance

- import_role:
    name: openshift_autogitops
    tasks_from: app_delete.yml
  vars:
    autogitops_app_name: openshift-virtualization-operator
    autogitops_app_path: openshift-virtualization/operator

- import_role:
    name: openshift_common
    tasks_from: get_infrastructure.yml

- import_tasks: cluster_nodes_delete.yml
