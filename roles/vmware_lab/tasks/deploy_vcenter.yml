- name: Retrieve vCenter virtual machine
  import_tasks: retrieve_vcenter_vm.yml

- name: Deploy vCenter Server Appliance
  import_tasks: deploy_vcenter_tasks.yml
  when: vcenter_vm is failed

- name: Retrieve vCenter virtual machine
  import_tasks: retrieve_vcenter_vm.yml
  when: vcenter_vm

- name: Reconfigure vCenter instance if needed
  import_tasks: configure_vcenter_vm.yml
  when: >
    vcenter_vm.instance.hw_memtotal_mb != vmware_lab.vcenter_vm.memory
    or vcenter_vm.instance.hw_eth0.macaddress != vmware_lab.vcenter_vm.macaddr
