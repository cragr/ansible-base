- name: Obtain infrastructure info
  kubernetes.core.k8s_info:
    api_version: config.openshift.io/v1
    kind: Infrastructure
    name: cluster
  register: openshift_postinstall_infrastructure

- name: Set openshift_postinstall_cluster_domain
  set_fact:
    openshift_postinstall_cluster_domain: >-
      {{ openshift_postinstall_infrastructure.resources.0.status.apiServerURL | regex_replace("https://api\.(.*):6443", "\1") }}

- debug:
    var: openshift_postinstall_cluster_domain
