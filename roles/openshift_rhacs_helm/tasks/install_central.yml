- name: Create namespace {{ rhacs_central_namespace }}
  kubernetes.core.k8s:
    definition: "{{ lookup('template', 'rhacs-central-ns.yaml') }}"

- name: Add RHACS chart repo
  kubernetes.core.helm_repository:
    name: rhacs
    repo_url: '{{ rhacs_helm_repo }}'

- name: Deploy RHACS Central
  kubernetes.core.helm:
    name: rhacs-central-services
    chart_ref: rhacs/central-services
    chart_version: '{{ rhacs_version }}'
    release_namespace: '{{ rhacs_central_namespace }}'
    release_values: '{{ lookup("template", "values.yaml") | from_yaml }}'
    wait: true

- name: Create route for Central
  kubernetes.core.k8s:
    definition: "{{ lookup('template', 'central-route.yaml') }}"
