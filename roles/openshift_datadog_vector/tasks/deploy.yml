- name: Create namespace {{ datadog_vector_namespace }}
  kubernetes.core.k8s:
    template:
      - namespace/vector-ns.yaml
  when: datadog_vector_manage_namespace

- name: Deploy Datadog Vector
  import_role:
    name: openshift_common
    tasks_from: kustomize.yml
  vars:
    kustomize_name: vector
    kustomize_files:
      - instance/kustomization.yaml
    kustomize_op: present

- import_role:
    name: openshift_common
    tasks_from: wait_for_deployment.yml
  vars:
    wait_for_deployment_name: '{{ datadog_vector_deployment_name }}'
    wait_for_deployment_namespace: '{{ datadog_vector_namespace }}'
