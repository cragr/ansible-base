apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
  namespace: {{ gitops_instance_namespace }}
data:
  repositories: |
    - type: helm
      url: https://external-secrets.github.io/kubernetes-external-secrets
      name: external-secrets
  resource.customizations.health.PersistentVolumeClaim: |
    hs = {}
    hs.status = "Unknown"
    hs.message = ""

    if obj.status ~= nil then
      if obj.status.phase ~= nil then
        phase = obj.status.phase
        if phase == "Lost" then
          hs.status = "Degraded"
        elseif phase == "Pending" then
          hs.status = "Healthy"
        elseif phase == "Bound" then
          hs.status = "Healthy"
        end
      end
    end

    return hs
